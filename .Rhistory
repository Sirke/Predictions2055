setwd("C:/Users/Sirke Piirainen/OneDrive - University of Helsinki/github_mallinnus/ortolan_bunting")
getwd()
paketit<-c("readr","tidyr","plyr","dplyr","vegan","ggplot2","lattice","psych","glmmTMB","lme4","MASS","MuMIn","mgcv","gamm4","ncf")
lapply(paketit,library,character.only=T)
data<-read.csv("OrtolanBunting.csv")
names(data)
str(data)
summary(data)
#tarkasta kaikkien luokkien muoto
data$id<-as.factor(data$id)
#luodaan vuodelle oma faktori-muuttuja
data$fyear<-as.factor(data$year)
#pinta-alalle myös oma log-muunnettu muuttuja
data$Larea=log(data$area)
sort(table(data$id))
mean(table(data$id))
a=table(data$id)
a
a=as.data.frame(table(data$id))
View(a)
colMeans(a$Freq)
mean(a$Freq)
table(data$terri)
hist(data$terri)
table(data$terri)
mean(table(data$terri))
table(data$terri)
knitr::opts_chunk$set(echo = TRUE)
#packages
getwd()
paketit<-c("here","dplyr","purrr","tidyverse")
lapply(paketit,library,character.only=T)
here::here()
abupres <- read.csv(here("data", "EPREDY_abu_pres.csv"))
abu26 <- read.csv(here("data", "EPREDY_abu_26.csv"))
abu45<- read.csv(here("data", "EPREDY_abu_45.csv"))
abu85<- read.csv(here("data", "EPREDY_abu_85.csv"))
papres<- read.csv(here("data", "EPREDY_pa_pres.csv"))
pa26<- read.csv(here("data", "EPREDY_pa_26.csv"))
pa45 <- read.csv(here("data", "EPREDY_pa_45.csv"))
pa85 <- read.csv(here("data", "EPREDY_pa_85.csv"))
grid <- read.csv(here("data", "XY.grid10_abu_85.csv"))
#jos haluaisin yhdistää kaikki csv:t yhteen dataframeen
#filefolder <- here("data")
#files <- dir(filefolder, pattern = "*.csv",full.names = T)
#files
#data <- files %>%
#  map(read_csv) %>%
#  reduce(cbind)
plot(grid)
summary(abupres)
glimpse(abupres)
View(abupres)
str(abupres)
#changes in total abundances from present to 2055 in scenario 26
abundances_pres=colSums(exp(abupres))
abundances_pres
abundances_26=colSums(exp(abu26))
abundances_26
#muutos
abuchange26=abundances_pres-abundances_26
abuchange26
sort(abuchange26)
#changes in total abundances from present to 2055 in scenario 26
abundances_pres=colSums(exp(abupres))
abundances_pres
abundances_26=colSums(exp(abu26))
abundances_26
#muutos
abuchange26=abundances_pres-abundances_26
abuchange26
sort(abuchange26)
#changes in total abundances from present to 2055 in scenario 45
#2055 according to scenario 45
abundances_245=colSums(exp(abu45))
#change
abuchange45=abundances_pres-abundances_45
#changes in total abundances from present to 2055 in scenario 45
#2055 according to scenario 45
abundances_45=colSums(exp(abu45))
#change
abuchange45=abundances_pres-abundances_45
sort(abuchange45)
#changes in total abundances from present to 2055 in scenario 45
#2055 according to scenario 45
abundances_45=colSums(exp(abu45))
#change
abuchange45=abundances_pres-abundances_45
sort(abuchange45)
#changes in total abundances from present to 2055 in scenario 85
#2055 according to scenario 85
abundances_85=colSums(exp(abu85))
#change
abuchange85=abundances_pres-abundances_85
sort(abuchange85)
View(abu26)
sp_name=names(abu26)
changes=sp_name
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
nrow(changes)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
nrow(changes)
for(i in 1:nrow(changes)){
changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
}
View(changes)
for(i in 1:nrow(changes)){
changes$abu26[i]=(colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))
changes$abu45[i]=(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))
changes$abu85[i]=(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))
}
for(i in 1:nrow(changes)){
changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))/colSums(exp(abupres[i]))
changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))/colSums(exp(abupres[i]))
changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))/colSums(exp(abupres[i]))
}
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
for(i in 1:nrow(changes)){
changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))/colSums(exp(abupres[i]))
changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))/colSums(exp(abupres[i]))
changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))/colSums(exp(abupres[i]))
}
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
for(i in 1:nrow(changes)){
changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
}
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=(colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))
changes$abu45[i]=(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))
changes$abu85[i]=(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))
}
abus=as.data.frame(sp_name)
abus$abupres=NA
abus$abu26=NA
abus$abu45=NA
abus$abu85=NA
#total population size predicted
for(i in 1:nrow(abus)){
abus$abupres[i]=colSums(exp(abupres[i]))
abus$abu26[i]=colSums(exp(abu26[i]))
abus$abu45[i]=colSums(exp(abu45[i]))
abus$abu85[i]=colSums(exp(abu85[i]))
}
View(abus)
str(abus)
str(changes)
9200/10086
1-0,91
1-0.91
10086*0.91
10086.0921*0.0878
10086.0921*1-0.0878
10086.0921*(1-0.0878)
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in absolute numbers
#for(i in 1:nrow(changes)){
#  changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
#  changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
#  changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
#}
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=1-(colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))
changes$abu45[i]=1-(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))
changes$abu85[i]=1-(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))
}
str(changes)
1-0.912
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in absolute numbers
#for(i in 1:nrow(changes)){
#  changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
#  changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
#  changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
#}
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=(colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))-1
changes$abu45[i]=(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))-1
changes$abu85[i]=(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))-1
}
str(changes)
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in absolute numbers
#for(i in 1:nrow(changes)){
#  changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
#  changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
#  changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
#}
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=((colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))-1)*100
changes$abu45[i]=(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))-1
changes$abu85[i]=(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))-1
}
str(changes)
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in absolute numbers
#for(i in 1:nrow(changes)){
#  changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
#  changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
#  changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
#}
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=((colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))-1
changes$abu45[i]=(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))-1
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in absolute numbers
#for(i in 1:nrow(changes)){
#  changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
#  changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
#  changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
#}
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=(colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))-1
changes$abu45[i]=(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))-1
changes$abu85[i]=(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))-1
}
str(changes)
sp_name=names(abu26)
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
#changes in absolute numbers
#for(i in 1:nrow(changes)){
#  changes$abu26[i]=colSums(exp(abupres[i]))-colSums(exp(abu26[i]))
#  changes$abu45[i]=colSums(exp(abupres[i]))-colSums(exp(abu45[i]))
#  changes$abu85[i]=colSums(exp(abupres[i]))-colSums(exp(abu85[i]))
#}
#changes in percentages
for(i in 1:nrow(changes)){
changes$abu26[i]=1-(colSums(exp(abupres[i]))-colSums(exp(abu26[i])))/colSums(exp(abupres[i]))
changes$abu45[i]=1-(colSums(exp(abupres[i]))-colSums(exp(abu45[i])))/colSums(exp(abupres[i]))
changes$abu85[i]=1-(colSums(exp(abupres[i]))-colSums(exp(abu85[i])))/colSums(exp(abupres[i]))
}
str(changes)
plot(abus$abupres[1],abus$abu26)
plot(abus$abupres[1],abus$abu26[1])
abus2= abus%>%gather(scenario,abundance,abupres:abu85)
abus2= abus%>%gather(scenario,abundance,3:5)
abus2= abus%>%gather(scenario,abundance,-sp_name, -abupres)
abus %>% gather(scenario,abundance,3:5)
abus2= abus %>% gather(abus,scenario,abundance,3:5)
abus2= gather(abus,scenario,abundance,3:5)
paketit<-c("here","dplyr","purrr","tidyverse","tidyr")
lapply(paketit,library,character.only=T)
abus2= gather(abus,scenario,abundance,3:5)
abus2= abus%>%gather("scenario"","abundance"",-sp_name, -abupres)
abus2= abus%>%gather("scenario","abundance",-sp_name, -abupres)
abus2= abus%>%gather("scenario","abundance",3:5)
abus2= abus%>%gather("scenario","abundance",abu26,abu45,abu85)
abus2= abus%>%gather(key="scenario",value="abundance",abupres,abu26,abu45,abu85)
abus2 %>% pivot_longer(c(abupres,abu26,abu45,abu85), names_to = "scenario", values_to = "abundance")
abus2=abus %>% pivot_longer(c(abupres,abu26,abu45,abu85), names_to = "scenario", values_to = "abundance")
View(abus2)
#plot an example
plot(abus2$abundance[1],abus$scenario[1])
#plot an example
ggplot(aes(abus2$abundance[1],abus$scenario[1]))+
geom_point()
#plot an example
ggplot(aes(abus2$abundance[1],abus2$scenario[1]))+
geom_point()
knitr::opts_chunk$set(echo = TRUE)
#packages
getwd()
paketit<-c("here","dplyr","purrr","tidyverse","tidyr")
lapply(paketit,library,character.only=T)
here::here()
abupres <- read.csv(here("data", "EPREDY_abu_pres.csv"))
abu26 <- read.csv(here("data", "EPREDY_abu_26.csv"))
abu45<- read.csv(here("data", "EPREDY_abu_45.csv"))
abu85<- read.csv(here("data", "EPREDY_abu_85.csv"))
papres<- read.csv(here("data", "EPREDY_pa_pres.csv"))
pa26<- read.csv(here("data", "EPREDY_pa_26.csv"))
pa45 <- read.csv(here("data", "EPREDY_pa_45.csv"))
pa85 <- read.csv(here("data", "EPREDY_pa_85.csv"))
grid <- read.csv(here("data", "XY.grid10_abu_85.csv"))
#jos haluaisin yhdistää kaikki csv:t yhteen dataframeen
#filefolder <- here("data")
#files <- dir(filefolder, pattern = "*.csv",full.names = T)
#files
#data <- files %>%
#  map(read_csv) %>%
#  reduce(cbind)
plot(grid)
str(abupres)
sp_name=names(abu26)
abus=as.data.frame(sp_name)
abus$abupres=NA
abus$abu26=NA
abus$abu45=NA
abus$abu85=NA
#total population size predicted
for(i in 1:nrow(abus)){
abus$abupres[i]=colSums(exp(abupres[i]))
abus$abu26[i]=colSums(exp(abu26[i]))
abus$abu45[i]=colSums(exp(abu45[i]))
abus$abu85[i]=colSums(exp(abu85[i]))
}
changes=as.data.frame(sp_name)
changes$abu26=NA
changes$abu45=NA
changes$abu85=NA
